<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor de Encordados de Raquetas v2.7.0</title>
    <link href="https://cdn.tailwindcss.com" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<!-- Agregar esto antes de </body> -->
<script>
    // Función para manejar la importación desde archivos locales
    function handleFileImport(type) {
        const fileInput = document.createElement('input');
        fileInput.type = 'file';
        fileInput.accept = '.csv';
        fileInput.onchange = (e) => {
            const file = e.target.files[0];
            const reader = new FileReader();
            reader.onload = (event) => {
                importarCSV(event.target.result, type);
            };
            reader.readAsText(file);
        };
        fileInput.click();
    }
</script>

<!-- Panel solo visible para admin -->
<div id="adminPanel" style="display:none;">
  <h2>Panel de administración</h2>
  <!-- Aquí puedes poner botones o secciones solo para admin -->
  <button onclick="alert('Función solo para admin')">Función admin</button>
</div>
	
<div id="loginContainer" class="flex flex-col items-center justify-center min-h-screen bg-gray-100" style="display:none;">
    <div class="bg-white p-8 rounded shadow-md w-full max-w-sm">
        <h2 class="text-2xl font-bold mb-4 text-center">Iniciar Sesión</h2>
        <form id="loginForm" class="space-y-4">
            <input type="email" id="loginEmail" class="w-full p-2 border rounded" placeholder="Correo" required>
            <input type="password" id="loginPassword" autocomplete="current-password" class="w-full p-2 border rounded" placeholder="Contraseña" required>
            <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded">Entrar</button>
        </form>
        <div id="loginError" class="text-red-600 mt-2 text-center"></div>
    </div>
</div>
<button id="logoutBtn" class="absolute top-4 right-4 bg-gray-200 px-4 py-2 rounded" style="display:none;">Cerrar sesión</button>

<body class="p-4 md:p-8">
    <div class="container mx-auto max-w-7xl bg-white p-6 md:p-8 rounded-xl shadow-2xl">
        <header class="mb-8 text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800">
                <i class="fas fa-racquet mr-2 text-blue-600"></i>Gestor de Encordados
            </h1>
            <p class="text-gray-600 mt-1">Bienvenido. User ID: <span id="userIdDisplay" class="font-semibold">Cargando...</span></p>
        </header>

        <div class="mb-6 border-b border-gray-200">
            <nav class="flex flex-wrap -mb-px" aria-label="Tabs">
                <button onclick="showTab('nuevaSolicitudTab')" class="tab-button active text-sm md:text-base whitespace-nowrap mr-2 py-3 px-4 border-b-2 font-medium rounded-t-lg hover:text-gray-600 hover:border-gray-300">
                    <i class="fas fa-plus-circle mr-1"></i>Nueva Solicitud
                </button>
                <button onclick="showTab('verSolicitudesTab')" class="tab-button text-sm md:text-base whitespace-nowrap mr-2 py-3 px-4 border-b-2 font-medium rounded-t-lg hover:text-gray-600 hover:border-gray-300">
                    <i class="fas fa-list-alt mr-1"></i>Ver Solicitudes
                </button>
                <button onclick="showTab('estadisticasTab')" class="tab-button text-sm md:text-base whitespace-nowrap mr-2 py-3 px-4 border-b-2 font-medium rounded-t-lg hover:text-gray-600 hover:border-gray-300">
                    <i class="fas fa-chart-pie mr-1"></i>Estadísticas
                </button>
                <button onclick="showTab('registrarJugadorTab')" class="tab-button text-sm md:text-base whitespace-nowrap mr-2 py-3 px-4 border-b-2 font-medium rounded-t-lg hover:text-gray-600 hover:border-gray-300">
                    <i class="fas fa-user-plus mr-1"></i>Registrar Jugador
                </button>
                <button onclick="showTab('verJugadoresTab')" class="tab-button text-sm md:text-base whitespace-nowrap py-3 px-4 border-b-2 font-medium rounded-t-lg hover:text-gray-600 hover:border-gray-300">
                    <i class="fas fa-users mr-1"></i>Ver Jugadores
                </button>
            </nav>
        </div>

        <main>
            <!-- Nueva Solicitud Tab -->
            <div id="nuevaSolicitudTab" class="tab-content">
                <h2 class="text-2xl font-semibold mb-6 text-gray-700">Crear Nueva Solicitud de Encordado</h2>
                <form id="formNuevaSolicitud" class="space-y-6">
                    <div class="autocomplete-container">
                        <label for="solicitudJugadorNombre" class="block text-sm font-medium text-gray-700 mb-1">Buscar Jugador:</label>
                        <input type="text" id="solicitudJugadorNombre" name="jugadorNombre" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500" placeholder="Escriba código o nombre...">
                        <input type="hidden" id="solicitudJugadorId" name="jugadorId">
                        <div id="error-jugadorId" class="error-message"></div>
                    </div>
                   
                   <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="solicitudMarcaRaqueta" class="block text-sm font-medium text-gray-700 mb-1">Marca de Raqueta:</label>
                            <input type="text" id="solicitudMarcaRaqueta" name="marcaRaqueta" required class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            <div id="error-marcaRaqueta" class="error-message"></div>
                        </div>
                        <div>
                            <label for="solicitudModeloRaqueta" class="block text-sm font-medium text-gray-700 mb-1">Modelo de Raqueta:</label>
                            <input type="text" id="solicitudModeloRaqueta" name="modeloRaqueta" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="solicitudTensionVertical" class="block text-sm font-medium text-gray-700 mb-1">Tensión Vertical (lbs/kg):</label>
                            <input type="number" id="solicitudTensionVertical" name="tensionVertical" step="0.1" required class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            <div id="error-tensionVertical" class="error-message"></div>
                        </div>
                        <div>
                            <label for="solicitudTensionHorizontal" class="block text-sm font-medium text-gray-700 mb-1">Tensión Horizontal (lbs/kg):</label>
                            <input type="number" id="solicitudTensionHorizontal" name="tensionHorizontal" step="0.1" required class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            <div id="error-tensionHorizontal" class="error-message"></div>
                        </div>
                    </div>
                    <div>
                        <label for="solicitudTipoCuerda" class="block text-sm font-medium text-gray-700 mb-1">Tipo de Cuerda (si la trae el cliente):</label>
                        <input type="text" id="solicitudTipoCuerda" name="tipoCuerda" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="solicitudFechaSolicitud" class="block text-sm font-medium text-gray-700 mb-1">Fecha de Solicitud:</label>
                            <input type="date" id="solicitudFechaSolicitud" name="fechaSolicitud" required class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            <div id="error-fechaSolicitud" class="error-message"></div>
                        </div>
                        <div>
                            <label for="solicitudFechaEntregaEstimada" class="block text-sm font-medium text-gray-700 mb-1">Fecha de Entrega Estimada:</label>
                            <input type="date" id="solicitudFechaEntregaEstimada" name="fechaEntregaEstimada" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>

                    <div class="flex items-center mt-2 mb-2">
                        <input type="checkbox" id="solicitudCuerdaIncluida" name="cuerdaIncluida" class="form-checkbox h-5 w-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                        <label for="solicitudCuerdaIncluida" class="ml-2 block text-sm font-medium text-gray-700">Cuerda Incluida (suministrada por nosotros)</label>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="solicitudPrecio" class="block text-sm font-medium text-gray-700 mb-1">Precio Sugerido/Final (€):</label>
                            <input type="number" id="solicitudPrecio" name="precio" step="0.01" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label for="solicitudEstadoPago" class="block text-sm font-medium text-gray-700 mb-1">Estado del Pago:</label>
                            <select id="solicitudEstadoPago" name="estadoPago" required class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                                <option value="Pendiente">Pendiente</option>
                                <option value="Pagado">Pagado</option>
                            </select>
                            <div id="error-estadoPago" class="error-message"></div>
                        </div>
                    </div>
                    <div>
                        <label for="solicitudNotas" class="block text-sm font-medium text-gray-700 mb-1">Notas Adicionales:</label>
                        <textarea id="solicitudNotas" name="notas" rows="3" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"></textarea>
                    </div>
                    <div>
                        <button type="submit" class="w-full md:w-auto bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out">
                            <i class="fas fa-save mr-2"></i>Guardar Solicitud
                        </button>
                    </div>
                </form>
            </div>

            <!-- Ver Solicitudes Tab -->
            <div id="verSolicitudesTab" class="tab-content" style="display: none;">
                <h2 class="text-2xl font-semibold mb-6 text-gray-700">Listado de Solicitudes de Encordado</h2>
                
                <div class="mb-6 p-4 bg-gray-50 rounded-lg shadow">
                    <h3 class="text-lg font-medium text-gray-800 mb-3">Filtrar Solicitudes:</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 items-end">
                        <div>
                            <label for="filtroJugador" class="block text-sm font-medium text-gray-700 mb-1">Por Jugador:</label>
                            <select id="filtroJugador" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                                <option value="">Todos los jugadores</option>
                            </select>
                        </div>
                        <div>
                            <label for="filtroEstadoPago" class="block text-sm font-medium text-gray-700 mb-1">Por Estado de Pago:</label>
                            <select id="filtroEstadoPago" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                                <option value="">Todos</option>
                                <option value="Pendiente">Pendiente</option>
                                <option value="Pagado">Pagado</option>
                            </select>
                        </div>
                        <div>
                            <label for="filtroEstadoEntrega" class="block text-sm font-medium text-gray-700 mb-1">Por Estado de Entrega:</label>
                            <select id="filtroEstadoEntrega" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                                <option value="">Todos</option>
                                <option value="Pendiente">Pendiente de Iniciar</option>
                                <option value="En Proceso">En Proceso</option>
                                <option value="Listo para Recoger">Listo para Recoger</option>
                                <option value="Entregado">Entregado</option>
                                <option value="Cancelado">Cancelado</option>
                            </select>
                        </div>
                        <div>
                            <label for="filtroFechaSolicitudDesde" class="block text-sm font-medium text-gray-700 mb-1">F. Solicitud Desde:</label>
                            <input type="date" id="filtroFechaSolicitudDesde" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label for="filtroFechaSolicitudHasta" class="block text-sm font-medium text-gray-700 mb-1">F. Solicitud Hasta:</label>
                            <input type="date" id="filtroFechaSolicitudHasta" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 items-end mt-4">
                        <div>
                            <label for="filtroFechaPagoDesde" class="block text-sm font-medium text-gray-700 mb-1">F. Pago Desde:</label>
                            <input type="date" id="filtroFechaPagoDesde" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label for="filtroFechaPagoHasta" class="block text-sm font-medium text-gray-700 mb-1">F. Pago Hasta:</label>
                            <input type="date" id="filtroFechaPagoHasta" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div class="col-span-1 sm:col-span-2 lg:col-span-1 xl:col-span-3 flex items-end space-x-2">
                            <button id="btnAplicarFiltros" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150 ease-in-out">
                                <i class="fas fa-filter mr-1"></i>Aplicar
                            </button>
                            <button id="btnLimpiarFiltros" class="w-full bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150 ease-in-out">
                                <i class="fas fa-times mr-1"></i>Limpiar
                            </button>
                        </div>
                    </div>
                </div>

                <div class="my-6 p-4 bg-gray-50 rounded-lg shadow">
                    <h3 class="text-lg font-medium text-gray-800 mb-3">Importar / Exportar Solicitudes</h3>
                    <div class="flex flex-col sm:flex-row gap-4 items-start">
                        <div class="flex-1">
                            <label for="importFile" class="block text-sm font-medium text-gray-700 mb-1">Importar desde CSV:</label>
                            <input type="file" id="importFile" accept=".csv" class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                            <button id="btnImportCsv" class="mt-2 w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150 ease-in-out text-sm">
                                <i class="fas fa-file-import mr-2"></i>Importar Archivo
                            </button>
                        </div>
                        <div class="flex-1 sm:text-right">
                            <button id="btnExportCsv" class="mt-2 w-full sm:w-auto bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150 ease-in-out text-sm">
                                <i class="fas fa-file-export mr-2"></i>Exportar a CSV (Filtradas)
                            </button>
                        </div>
                        <div class="flex-1 sm:text-right">
                            <button id="btnDeleteSelected" class="mt-2 w-full sm:w-auto bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-150 ease-in-out text-sm">
                                <i class="fas fa-trash-alt mr-2"></i>Eliminar Seleccionadas
                            </button>
                        </div>
                    </div>
                    <p class="mt-3 text-xs text-gray-500">
    			<strong>Formato CSV esperado para importar:</strong><br>
    			Encabezados: <code>Código Jugador,Nombre Jugador,Marca Raqueta,Modelo Raqueta,Tensión Vertical,Tensión Horizontal,Tipo Cuerda,Cuerda Incluida,Fecha Solicitud,Fecha Entrega Estimada,Precio,Estado Pago,Estado Entrega,Notas,Fecha Pago</code><br>
  			<code>Cuerda Incluida</code> debe ser "Sí" o "No". Fechas como <strong>dd/mm/aaaa</strong>.
		   </p>
                </div>

                <div id="listaSolicitudesContainer" class="table-responsive">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    <input type="checkbox" id="selectAllSolicitudes" class="form-checkbox h-4 w-4">
                                </th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Jugador</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Raqueta</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tensión (V/H)</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">F. Solicitud</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">F. Entrega</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Precio (€)</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Pago</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Entrega</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="listaSolicitudes" class="bg-white divide-y divide-gray-200">
                            <tr><td colspan="10" class="text-center p-4 text-gray-500">Cargando solicitudes...</td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Resumen de solicitudes -->
					<div class="grid grid-cols-1 md:grid-cols-4 gap-4">
						<div class="stat-card">
							<h4 class="text-sm font-medium text-gray-700">Total Solicitudes</h4>
							<p id="resumenTotalSolicitudes" class="text-xl font-bold text-blue-600">0</p>
						</div>
						<div class="stat-card">
							<h4 class="text-sm font-medium text-gray-700">Pagadas</h4>
							<p id="resumenSolicitudesPagadas" class="text-xl font-bold text-green-600">0</p>
						</div>
						<div class="stat-card">
							<h4 class="text-sm font-medium text-gray-700">Pendientes</h4>
							<p id="resumenSolicitudesPendientes" class="text-xl font-bold text-yellow-600">0</p>
						</div>
						<div class="stat-card">
							<h4 class="text-sm font-medium text-gray-700">Total Ingresos</h4>
							<p id="resumenTotalIngresos" class="text-xl font-bold text-purple-600">0.00€</p>
						</div>
				  </div>
        </div>
</div>		
            <!-- Estadísticas Tab -->
            <div id="estadisticasTab" class="tab-content" style="display: none;">
                <h2 class="text-2xl font-semibold mb-6 text-gray-700">Panel de Estadísticas</h2>
                <p class="mb-4 text-sm text-gray-600">Las estadísticas se basan en las solicitudes actualmente visibles (afectadas por los filtros de la pestaña "Ver Solicitudes").</p>
                
                <!-- Tarjetas de resumen -->
                <div class="stats-grid">
                    <div class="stats-card">
                        <h3>Total Solicitudes</h3>
                        <p id="statTotalSolicitudes" class="text-blue-600">0</p>
                    </div>
                    <div class="stats-card">
                        <h3>Ingresos Totales</h3>
                        <p id="statIngresosTotales" class="text-green-600">0.00 €</p>
                    </div>
                    <div class="stats-card">
                        <h3>Precio Promedio</h3>
                        <p id="statPrecioPromedio" class="text-indigo-600">0.00 €</p>
                    </div>
                    <div class="stats-card">
                        <h3>Solicitudes Hoy</h3>
                        <p id="statSolicitudesHoy" class="text-purple-600">0</p>
                    </div>
					<div class="stats-card">
						<h3>Ingresos últimos 30 días</h3>
						<p id="statIngresos30Dias" class="text-purple-600">0.00 €</p>
				   </div>
					<div class="stats-card">
						<h3>Promedio diario</h3>
						<p id="statPromedioDiario" class="text-indigo-600">0.00 €</p>
				    </div>
				</div>
                
                <!-- Gráficos principales -->
                <div class="charts-grid">
                    <!-- Gráfico de estado de pago -->
                    <div class="chart-card">
                        <h3>Estado de Pago</h3>
                        <canvas id="pagoChart"></canvas>
                    </div>
                    
                    <!-- Gráfico de estado de entrega -->
                    <div class="chart-card">
                        <h3>Estado de Entrega</h3>
                        <canvas id="entregaChart"></canvas>
                    </div>
                </div>
                
                <!-- Gráficos secundarios -->
                <div class="charts-grid mt-4">
                    <!-- Gráfico de ingresos mensuales -->
                    <div class="chart-card">
                        <h3>Ingresos Mensuales</h3>
                        <canvas id="ingresosChart"></canvas>
                    </div>
                    
                    <!-- Gráfico de solicitudes por jugador -->
                    <div class="chart-card">
                        <h3>Top 5 Jugadores</h3>
                        <canvas id="jugadoresChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Registrar Jugador Tab -->
            <div id="registrarJugadorTab" class="tab-content" style="display: none;">
                <h2 class="text-2xl font-semibold mb-6 text-gray-700">Registrar Nuevo Jugador</h2>
                <form id="formRegistrarJugador" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="jugadorCodigo" class="block text-sm font-medium text-gray-700 mb-1">Código de Jugador:</label>
                            <input type="text" id="jugadorCodigo" name="codigo" required class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            <div id="error-codigo" class="error-message"></div>
                        </div>
                        <div>
                            <label for="jugadorNombreCompleto" class="block text-sm font-medium text-gray-700 mb-1">Nombre Completo:</label>
                            <input type="text" id="jugadorNombreCompleto" name="nombreCompleto" required class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            <div id="error-nombreCompleto" class="error-message"></div>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="jugadorTelefono" class="block text-sm font-medium text-gray-700 mb-1">Teléfono (Opcional):</label>
                            <input type="text" id="jugadorTelefono" name="telefono" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label for="jugadorEmail" class="block text-sm font-medium text-gray-700 mb-1">Email (Opcional):</label>
                            <input type="email" id="jugadorEmail" name="email" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            <div id="error-email" class="error-message"></div>
                        </div>
                    </div>
                    
                    <div class="border-t border-gray-200 pt-4">
                        <h3 class="text-lg font-medium text-gray-800 mb-4">Preferencias de Raqueta</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="jugadorMarcaRaqueta" class="block text-sm font-medium text-gray-700 mb-1">Marca de Raqueta:</label>
                                <input type="text" id="jugadorMarcaRaqueta" name="marcaRaqueta" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <label for="jugadorModeloRaqueta" class="block text-sm font-medium text-gray-700 mb-1">Modelo de Raqueta:</label>
                                <input type="text" id="jugadorModeloRaqueta" name="modeloRaqueta" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                            <div>
                                <label for="jugadorTensionVertical" class="block text-sm font-medium text-gray-700 mb-1">Tensión Vertical (lbs/kg):</label>
                                <input type="number" id="jugadorTensionVertical" name="tensionVertical" step="0.1" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div>
                                <label for="jugadorTensionHorizontal" class="block text-sm font-medium text-gray-700 mb-1">Tensión Horizontal (lbs/kg):</label>
                                <input type="number" id="jugadorTensionHorizontal" name="tensionHorizontal" step="0.1" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            </div>
                        </div>
                        <div class="mt-4">
                            <label for="jugadorTipoCuerda" class="block text-sm font-medium text-gray-700 mb-1">Tipo de Cuerda Preferida:</label>
                            <input type="text" id="jugadorTipoCuerda" name="tipoCuerda" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    
                    <div>
                        <button type="submit" class="w-full md:w-auto bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out">
                            <i class="fas fa-user-check mr-2"></i>Registrar Jugador
                        </button>
                    </div>
                </form>
            </div>

            <!-- Ver Jugadores Tab -->
            <div id="verJugadoresTab" class="tab-content" style="display: none;">
                <h2 class="text-2xl font-semibold mb-6 text-gray-700">Listado de Jugadores</h2>
                <div id="listaJugadoresContainer" class="table-responsive">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-100">
                            <tr>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Código</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nombre Completo</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Teléfono</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Raqueta</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">F. Registro</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="listaJugadores" class="bg-white divide-y divide-gray-200">
                           <tr><td colspan="7" class="text-center p-4 text-gray-500">Cargando jugadores...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <!-- Modales -->
    <div id="messageModal" class="modal">
        <div class="modal-content text-center">
            <p id="modalMessageText" class="text-lg mb-4"></p>
            <button id="modalCloseButton" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg">Cerrar</button>
        </div>
    </div>

    <div id="confirmModal" class="modal">
        <div class="modal-content text-center">
            <p id="confirmModalText" class="text-lg mb-6"></p>
            <div class="flex justify-center space-x-4">
                <button id="confirmModalCancel" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-5 rounded-lg">Cancelar</button>
                <button id="confirmModalConfirm" class="bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-5 rounded-lg">Confirmar</button>
            </div>
        </div>
    </div>

    <div id="editJugadorModal" class="modal">
        <div class="modal-content">
            <h3 class="text-xl font-semibold mb-5">Editar Jugador</h3>
            <form id="formEditJugador" class="space-y-4">
                <input type="hidden" id="editJugadorId">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="editJugadorCodigo" class="block text-sm font-medium text-gray-700 mb-1">Código de Jugador:</label>
                        <input type="text" id="editJugadorCodigo" name="codigo" required class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        <div id="error-editCodigo" class="error-message"></div>
                    </div>
                    <div>
                        <label for="editJugadorNombreCompleto" class="block text-sm font-medium text-gray-700 mb-1">Nombre Completo:</label>
                        <input type="text" id="editJugadorNombreCompleto" name="nombreCompleto" required class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        <div id="error-editNombreCompleto" class="error-message"></div>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="editJugadorTelefono" class="block text-sm font-medium text-gray-700 mb-1">Teléfono:</label>
                        <input type="text" id="editJugadorTelefono" name="telefono" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label for="editJugadorEmail" class="block text-sm font-medium text-gray-700 mb-1">Email:</label>
                        <input type="email" id="editJugadorEmail" name="email" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        <div id="error-editEmail" class="error-message"></div>
                    </div>
                </div>
                
                <div class="border-t border-gray-200 pt-4">
                    <h3 class="text-lg font-medium text-gray-800 mb-4">Preferencias de Raqueta</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="editJugadorMarcaRaqueta" class="block text-sm font-medium text-gray-700 mb-1">Marca de Raqueta:</label>
                            <input type="text" id="editJugadorMarcaRaqueta" name="marcaRaqueta" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label for="editJugadorModeloRaqueta" class="block text-sm font-medium text-gray-700 mb-1">Modelo de Raqueta:</label>
                            <input type="text" id="editJugadorModeloRaqueta" name="modeloRaqueta" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div>
                            <label for="editJugadorTensionVertical" class="block text-sm font-medium text-gray-700 mb-1">Tensión Vertical (lbs/kg):</label>
                            <input type="number" id="editJugadorTensionVertical" name="tensionVertical" step="0.1" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        </div>
                        <div>
                            <label for="editJugadorTensionHorizontal" class="block text-sm font-medium text-gray-700 mb-1">Tensión Horizontal (lbs/kg):</label>
                            <input type="number" id="editJugadorTensionHorizontal" name="tensionHorizontal" step="0.1" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div class="mt-4">
                        <label for="editJugadorTipoCuerda" class="block text-sm font-medium text-gray-700 mb-1">Tipo de Cuerda Preferida:</label>
                        <input type="text" id="editJugadorTipoCuerda" name="tipoCuerda" class="w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
                
                <div class="flex justify-end space-x-3 pt-3">
                    <button type="button" id="cancelEditJugador" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded-lg">Cancelar</button>
                    <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg">Guardar Cambios</button>
                </div>
            </form>
        </div>
    </div>

    <div id="editSolicitudModal" class="modal">
        <div class="modal-content">
            <h3 class="text-xl font-semibold mb-5">Editar Solicitud de Encordado</h3>
            <form id="formEditSolicitud" class="space-y-4">
                <input type="hidden" id="editSolicitudId">
                
                <div>
                    <label for="editSolicitudJugadorIdDisplay" class="block text-sm font-medium text-gray-700 mb-1">Jugador:</label>
                    <input type="text" id="editSolicitudJugadorIdDisplay" disabled class="w-full p-3 border border-gray-300 rounded-md shadow-sm bg-gray-100">
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="editSolicitudMarcaRaqueta" class="block text-sm font-medium text-gray-700 mb-1">Marca Raqueta:</label>
                        <input type="text" id="editSolicitudMarcaRaqueta" required class="w-full p-3 border border-gray-300 rounded-md shadow-sm">
                        <div id="error-editMarcaRaqueta" class="error-message"></div>
                    </div>
                    <div>
                        <label for="editSolicitudModeloRaqueta" class="block text-sm font-medium text-gray-700 mb-1">Modelo Raqueta:</label>
                        <input type="text" id="editSolicitudModeloRaqueta" class="w-full p-3 border border-gray-300 rounded-md shadow-sm">
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="editSolicitudTensionVertical" class="block text-sm font-medium text-gray-700 mb-1">Tensión Vertical:</label>
                        <input type="number" id="editSolicitudTensionVertical" step="0.1" required class="w-full p-3 border border-gray-300 rounded-md shadow-sm">
                        <div id="error-editTensionVertical" class="error-message"></div>
                    </div>
                    <div>
                        <label for="editSolicitudTensionHorizontal" class="block text-sm font-medium text-gray-700 mb-1">Tensión Horizontal:</label>
                        <input type="number" id="editSolicitudTensionHorizontal" step="0.1" required class="w-full p-3 border border-gray-300 rounded-md shadow-sm">
                        <div id="error-editTensionHorizontal" class="error-message"></div>
                    </div>
                </div>
                
                <div>
                    <label for="editSolicitudTipoCuerda" class="block text-sm font-medium text-gray-700 mb-1">Tipo de Cuerda (si la trae el cliente):</label>
                    <input type="text" id="editSolicitudTipoCuerda" class="w-full p-3 border border-gray-300 rounded-md shadow-sm">
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="editSolicitudFechaSolicitud" class="block text-sm font-medium text-gray-700 mb-1">Fecha Solicitud:</label>
                        <input type="date" id="editSolicitudFechaSolicitud" required class="w-full p-3 border border-gray-300 rounded-md shadow-sm">
                        <div id="error-editFechaSolicitud" class="error-message"></div>
                    </div>
                    <div>
                        <label for="editSolicitudFechaEntregaEstimada" class="block text-sm font-medium text-gray-700 mb-1">Fecha Entrega Est.:</label>
                        <input type="date" id="editSolicitudFechaEntregaEstimada" class="w-full p-3 border border-gray-300 rounded-md shadow-sm">
                    </div>
                </div>
                
                <div class="flex items-center mt-1 mb-1">
                    <input type="checkbox" id="editSolicitudCuerdaIncluida" name="cuerdaIncluida" class="form-checkbox h-5 w-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                    <label for="editSolicitudCuerdaIncluida" class="ml-2 block text-sm font-medium text-gray-700">Cuerda Incluida (suministrada por nosotros)</label>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="editSolicitudPrecio" class="block text-sm font-medium text-gray-700 mb-1">Precio Sugerido/Final (€):</label>
                        <input type="number" id="editSolicitudPrecio" step="0.01" class="w-full p-3 border border-gray-300 rounded-md shadow-sm">
                    </div>
                    <div>
                        <label for="editSolicitudEstadoPago" class="block text-sm font-medium text-gray-700 mb-1">Estado Pago:</label>
                        <select id="editSolicitudEstadoPago" required class="w-full p-3 border border-gray-300 rounded-md shadow-sm">
                            <option value="Pendiente">Pendiente</option>
                            <option value="Pagado">Pagado</option>
                        </select>
                        <div id="error-editEstadoPago" class="error-message"></div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="editSolicitudFechaPago" class="block text-sm font-medium text-gray-700 mb-1">Fecha de Pago:</label>
                        <input type="date" id="editSolicitudFechaPago" class="w-full p-3 border border-gray-300 rounded-md shadow-sm">
                    </div>
                    <div>
                        <label for="editSolicitudEstadoEntrega" class="block text-sm font-medium text-gray-700 mb-1">Estado Entrega:</label>
                        <select id="editSolicitudEstadoEntrega" required class="w-full p-3 border border-gray-300 rounded-md shadow-sm">
                            <option value="Pendiente">Pendiente de Iniciar</option>
                            <option value="En Proceso">En Proceso</option>
                            <option value="Listo para Recoger">Listo para Recoger</option>
                            <option value="Entregado">Entregado</option>
                            <option value="Cancelado">Cancelado</option>
                        </select>
                        <div id="error-editEstadoEntrega" class="error-message"></div>
                    </div>
                </div>
                
                <div>
                    <label for="editSolicitudNotas" class="block text-sm font-medium text-gray-700 mb-1">Notas Adicionales:</label>
                    <textarea id="editSolicitudNotas" rows="2" class="w-full p-3 border border-gray-300 rounded-md shadow-sm"></textarea>
                </div>

                <div class="flex justify-end space-x-3 pt-3">
                    <button type="button" id="cancelEditSolicitud" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded-lg">Cancelar</button>
                    <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg">Guardar Cambios</button>
                </div>
            </form>
        </div>
    </div>

<!-- ===== PANEL DE ADMINISTRACIÓN ===== -->
<div id="adminPanel" class="fixed bottom-4 right-4 bg-white p-4 rounded-lg shadow-lg z-50" style="display: none;">
    <h3 class="font-bold text-lg mb-2">Panel de Administración</h3>
    <div class="space-y-2">
        <button onclick="showAccessLogs()" class="w-full bg-blue-100 hover:bg-blue-200 text-blue-800 py-1 px-3 rounded text-sm">
            <i class="fas fa-history mr-1"></i> Registros de Acceso
        </button>
        <button onclick="exportAllData()" class="w-full bg-green-100 hover:bg-green-200 text-green-800 py-1 px-3 rounded text-sm">
            <i class="fas fa-download mr-1"></i> Exportar Datos
        </button>
        <button onclick="showSecuritySettings()" class="w-full bg-purple-100 hover:bg-purple-200 text-purple-800 py-1 px-3 rounded text-sm">
            <i class="fas fa-shield-alt mr-1"></i> Configuración
        </button>
    </div>
</div>


    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module" src="app.js"></script>
	
	<div id="adminPanel" class="fixed bottom-4 right-4 bg-white p-4 rounded-lg shadow-lg z-50" style="display: none;">
    <h3 class="font-bold text-lg mb-2">Panel de Administración</h3>
    <div class="space-y-2">
        <button onclick="showAccessLogs()" class="w-full bg-blue-100 hover:bg-blue-200 text-blue-800 py-1 px-3 rounded text-sm">
            <i class="fas fa-history mr-1"></i>Registros de Acceso
        </button>
        <button onclick="exportAllData()" class="w-full bg-green-100 hover:bg-green-200 text-green-800 py-1 px-3 rounded text-sm">
            <i class="fas fa-download mr-1"></i>Exportar Datos
        </button>
        <button onclick="showSecuritySettings()" class="w-full bg-purple-100 hover:bg-purple-200 text-purple-800 py-1 px-3 rounded text-sm">
            <i class="fas fa-shield-alt mr-1"></i>Configuración de Seguridad
        </button>
    </div>
</div>

<!-- Modal para registros de acceso -->
<div id="accessLogsModal" class="modal">
    <div class="modal-content max-w-2xl">
        <h3 class="text-xl font-bold mb-4">Registros de Acceso</h3>
        <div class="max-h-96 overflow-y-auto mb-4">
            <table class="min-w-full">
                <thead>
                    <tr class="bg-gray-100">
                        <th class="px-4 py-2 text-left">Fecha/Hora</th>
                        <th class="px-4 py-2 text-left">Dirección IP</th>
                    </tr>
                </thead>
                <tbody id="accessLogsBody"></tbody>
            </table>
        </div>
        <button onclick="document.getElementById('accessLogsModal').style.display='none'" 
                class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded">
            Cerrar
        </button>
    </div>
</div>

<!-- Modal de configuración de seguridad -->
<div id="securitySettingsModal" class="modal">
    <div class="modal-content max-w-md">
        <h3 class="text-xl font-bold mb-4">Configuración de Seguridad</h3>
        <div class="space-y-4">
            <div>
                <label class="flex items-center space-x-2">
                    <input type="checkbox" id="inactivityTimeoutEnabled" class="form-checkbox" checked>
                    <span>Cierre automático por inactividad (30 min)</span>
                </label>
            </div>
            <div>
                <label class="flex items-center space-x-2">
                    <input type="checkbox" id="auditLogEnabled" class="form-checkbox" checked>
                    <span>Registro de actividades</span>
                </label>
            </div>
            <div>
                <label class="flex items-center space-x-2">
                    <input type="checkbox" id="inputSanitizationEnabled" class="form-checkbox" checked>
                    <span>Sanitización de entradas</span>
                </label>
            </div>
        </div>
        <div class="flex justify-end space-x-3 mt-6">
            <button onclick="document.getElementById('securitySettingsModal').style.display='none'" 
                    class="bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 px-4 rounded">
                Cancelar
            </button>
            <button onclick="saveSecuritySettings()" 
                    class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded">
                Guardar
            </button>
        </div>
    </div>
</div>
	
</body>
</html>
